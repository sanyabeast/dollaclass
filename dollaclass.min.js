"use strict";!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof module&&module.exports?module.exports=t(!0):(window.$Class=t(),window.$Interface=window.$Class.$Interface)}(0,function(){var $classIDs=[];window.k=$classIDs;var Toolchain=function(){};Toolchain.prototype={loop:function(e,t,n){if(e instanceof window.Array)for(var o=0,r=e.length;o<r;o++)t.call(n,e[o],o,e);else if(e instanceof window.Object)for(var o in e)t.call(n,e[o],o,e)},join:function(){var e=Array.prototype.slice.call(arguments),t=e[0];return e.slice(1,e.length).join(t)},toArray:function(e){return Array.prototype.slice.call(e)},clone:function(e){if(e instanceof Array)return e.slice();var t={};return this.loop(e,function(e,n){t[n]=e},this),t},genRandString:function(e,t,n){for(var o="";o.length<e;)o+=Math.random().toString(32).substring(3,12);return o=[t||"",o.substring(0,e),n||""].join("-")},isDollaClass:function(e){return $classIDs.indexOf(e.$$id)>-1},merge:function(e,t,n){var o=this.clone(e);for(var r in t)o[r]=t[r];return o}};var _=new Toolchain,$Class=function(e,t){void 0===t&&(t=e,e={}),(e=_.clone(e)).name=e.name||_.genRandString("AnonymousClass");var n=this.__createClass(e,t);return e.namespace&&$Class.$namespace.$export(e.namespace,e.name,n),Object.defineProperty(n,"$$id",{value:_.genRandString(32,e.name,"class"),enumerable:!1,writable:!1,configurable:!1}),$classIDs.push(n.$$id),n};$Class.prototype={__createClass:function(e,t){var n,o=e.name,r=e.extends||null,a=e.interfaces||null;if("function"==typeof t.$constructor?(n=t.$constructor,delete t.$constructor):n=function(){},n=this.__addSuper(n,o,!0),!0===e.singleton){var s=n,i=null;n=function(){return i instanceof s?i:i=s.apply(this,arguments)}}return this.__setupProto(o,n,t,r,a),n.$interfaces&&_.loop(n.$interfaces,function(e,t){e instanceof $Interface&&e.__validateClass(n)}),n},__setupProto:function(e,t,n,o,r){o&&(o instanceof Array?_.loop(o,function(e,n){_.isDollaClass(e)||(e=this.__convertToDollaClass(e)),_.loop(e.$prototype,function(e,n){1==e.static&&this.__defineProperty(t,n,e),this.__defineProperty(t.prototype,n,e)},this)},this):(_.isDollaClass(o)||(o=this.__convertToDollaClass(o)),_.loop(o.$prototype,function(e,n){1==e.static&&this.__defineProperty(t,n,e),this.__defineProperty(t.prototype,n,e)},this)),this.__defineProperty(t.prototype,"$super",{value:o,enumerable:!1,writable:!1,configurable:!1}),this.__defineProperty(t.prototype,"$extends",{value:o,enumerable:!1,writable:!1,configurable:!1})),r&&this.__defineProperty(t,"$interfaces",{value:r,enumerable:!1,writable:!1,configurable:!1}),this.__defineProperty(t,"$prototype",{value:n,enumerable:!1,writable:!1,configurable:!1}),_.loop(n,function(e,n,o){"function"==typeof e?e=o[n]=this.__addSuper(e,n,!1):"function"==typeof e.value&&(e.value=this.__addSuper(e.value,n,!1)),!0===e.static&&this.__defineProperty(t,n,e),this.__defineProperty(t.prototype,n,e)},this),this.__defineProperty(t,"$constructor",{value:t,enumerable:!1,writable:!1,configurable:!1}),this.__defineProperty(t,"$name",{value:e,enumerable:!1,writable:!1,configurable:!1}),this.__defineProperty(t.prototype,"$name",{value:e,enumerable:!1,writable:!1,configurable:!1}),this.__defineProperty(t,"extend",{value:this.__extend.bind(this,t),enumerable:!1,writable:!1,configurable:!1})},__extend:function(e,t,n,o){return new Klass(t,e,n,o)},__addSuper(func,name,isConstructor){var wrapped=function(){var e,t=Array.prototype.slice.call(arguments);return e=func.super?func.super:isConstructor?function(e){if("function"==typeof this.$super&&"function"==typeof this.$super.$constructor)this.$super.$constructor.apply(this,e);else if(this.$super instanceof Array){var t=this.$super.length-1;"function"==typeof this.$super[t]&&"function"==typeof this.$super[t].$constructor&&this.$super[t].$constructor.apply(this,e)}}:function(e){if(this.$super&&this.$super.$prototype&&"function"==typeof this.$super.$prototype[name])this.$super.$prototype[name].apply(this,e);else if(this.$super instanceof Array){var t=this.$super.length-1;this.$super[t]&&this.$super[t].$prototype&&"function"==typeof this.$super[t].$prototype[name]&&this.$super[t].$prototype[name].apply(this,e)}},this.super=func.super=e.bind(this,t),func.apply(this,t)};return isConstructor&&(wrapped=eval(["var ",name,"=",wrapped.toString(),";",name,";"].join(""))),wrapped},__checkInterfacesImplementation:function(){},__defineProperty:function(e,t,n){"function"==typeof n?Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0}):"function"!=typeof data&&"undefined"!=typeof data&&null!==data&&void 0===data.value&&"function"!=typeof data.get&&"function"!=typeof data.set?(console.warn(new Error("$Class: property defining warning: auto-detected first-layer property; This may cause errors")),Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})):Object.defineProperty(e,t,n)},__convertToDollaClass:function(e){if("string"==typeof e)return this.$namespace.$importFullPath(e);if("function"==typeof e){console.warn("$Class: some of provided constructors were not created by $Class There may be some issues."),console.log(e);var t=e.toString().match(/([a-zA-Z_{1}][a-zA-Z0-9_]+)(?=\()/g);return t&&t[0]&&(t=t[0]),"function"==t&&(t="ConvertedClass"),new $Class({name:t||"ConvertedClass"},_.merge({$constructor:e},e.prototype))}console.warn("$Class: provided data cannot be converted to $Class")}};var $Namespace=new $Class({name:"$Namespace"},{$constructor:function(){},content:{value:{},writable:!1,configurable:!1},$import:function(e,t){if(this.content[_.join(".",e,t)])return this.content[_.join(".",e,t)];console.error(new Error("$Class: Import failed: `"+t+"` not found at `"+e+"`."))},$export:function(e,t,n){this.content[_.join(".",e,t)]?console.error(new Error("$Class: Export failed: `"+t+"` already exists at `"+e+"`.")):this.content[_.join(".",e,t)]=n},$importFullPath:function(e){var t=e.split("."),n=t.pop(),o=t.join(".");return this.$import(o,n)}}),$Interface=new $Class({name:"$Interface"},{$constructor:function(e){this.params=e},__validateClass:function(e){var t=!0;return _.loop(this.params,function(n,o){null!=(typeof e.prototype[o]).match(new RegExp(n))&&(t=!1,console.error("$Class: The implementation of does not match the interface: `"+o+"` is not a `"+n+"`, it's a `"+typeof e.prototype[o]+"`"))}),t}}),Toolchain=new $Class({name:"Toolchain"},_.merge({$constructor:Toolchain},Toolchain.prototype));return $Class=new $Class({name:"$Class"},_.merge({$constructor:$Class,convert:{value:$Class.prototype.__convertToDollaClass,static:!0},$Interface:{value:$Interface,static:!0},_:{value:new Toolchain,static:!0},$Namespace:{value:$Namespace,static:!0},$namespace:{value:new $Namespace,static:!0}},$Class.prototype)),$Class});